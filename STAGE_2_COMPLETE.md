# ‚úÖ –≠—Ç–∞–ø 2 –ó–∞–≤–µ—Ä—à—ë–Ω: Battle –º—É–∑—ã–∫–∞ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ battle –º—É–∑—ã–∫–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `audioAssets.ts` —Å –ø—É—Ç—ë–º –∫ battle —Ç—Ä–µ–∫—É
- ‚úÖ –ì–æ—Ç–æ–≤—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ç—Ä–µ–∫–æ–≤

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º—É–∑—ã–∫–∏
- ‚úÖ **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é** (`/`) ‚Üí –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ `fantasy-village-woods.mp3`
- ‚úÖ **–ë–∏—Ç–≤–∞** (`/game`) ‚Üí Battle –º—É–∑—ã–∫–∞ `death-taker.mp3`
- ‚úÖ –ü–ª–∞–≤–Ω—ã–π fade –ø–µ—Ä–µ—Ö–æ–¥ (500ms) –º–µ–∂–¥—É —Ç—Ä–µ–∫–∞–º–∏

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–≥—Ä–æ–≤—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- ‚úÖ `HomePage` ‚Üí –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏
- ‚úÖ `GamePage` ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ battle –º—É–∑—ã–∫—É –ø—Ä–∏ –≤—Ö–æ–¥–µ
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –∫ —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–µ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –∏–≥—Ä—ã

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `AUDIO_README.md` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω `battle/README.md` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é —Ñ–∞–π–ª–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
apps/frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              # HomePage - —Ñ–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ ‚úÖ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ game/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx          # GamePage - battle –º—É–∑—ã–∫–∞ ‚úÖ
‚îÇ   ‚îî‚îÄ‚îÄ lib/
‚îÇ       ‚îú‚îÄ‚îÄ constants/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ audioAssets.ts    # –ü—É—Ç–∏ –∫ —Ç—Ä–µ–∫–∞–º–∏ ‚úÖ
‚îÇ       ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ useAudio.ts       # –•—É–∫–∏ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
‚îÇ       ‚îú‚îÄ‚îÄ services/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ audioService.ts   # –°–µ—Ä–≤–∏—Å (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
‚îÇ       ‚îî‚îÄ‚îÄ store/
‚îÇ           ‚îî‚îÄ‚îÄ audioStore.ts     # Store (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
‚îî‚îÄ‚îÄ public/
    ‚îî‚îÄ‚îÄ audio/
        ‚îî‚îÄ‚îÄ music/
            ‚îú‚îÄ‚îÄ background/
            ‚îÇ   ‚îî‚îÄ‚îÄ fantasy-village-woods.mp3  ‚úÖ –ï—Å—Ç—å
            ‚îî‚îÄ‚îÄ battle/
                ‚îú‚îÄ‚îÄ death-taker.mp3            ‚ùå –ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨
                ‚îî‚îÄ‚îÄ README.md                  ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

## üéµ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –î–æ–±–∞–≤–∏—Ç—å battle –º—É–∑—ã–∫—É:

1. **–°–∫–∞—á–∞–π—Ç–µ —Ç—Ä–µ–∫**: Death Taker Battle Music
   - https://www.pond5.com/ru/royalty-free-music/item/143338201-death-taker-battle-music-fantasy-orchestral-loop

2. **–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ MP3** (–µ—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç WAV):
   ```bash
   ffmpeg -i death-taker.wav -codec:a libmp3lame -q:a 2 death-taker.mp3
   ```

3. **–ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª**:
   ```
   apps/frontend/public/audio/music/battle/death-taker.mp3
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   pnpm dev
   ```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º—É–∑—ã–∫–∏:

1. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
   - –î–æ–ª–∂–Ω–∞ –∏–≥—Ä–∞—Ç—å —Ñ–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞

2. ‚úÖ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ PVP (—Ü–µ–Ω—Ç—Ä —ç–∫—Ä–∞–Ω–∞)
   - –ü–µ—Ä–µ–π–¥—ë—Ç–µ –≤ `/play`
   - –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏–≥—Ä–∞—Ç—å

3. ‚úÖ –ù–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É (–ø–æ–ø–∞–¥—ë—Ç–µ –Ω–∞ `/game`)
   - –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ –ø–ª–∞–≤–Ω–æ –∑–∞—Ç—É—Ö–Ω–µ—Ç
   - Battle –º—É–∑—ã–∫–∞ –ø–ª–∞–≤–Ω–æ –Ω–∞—á–Ω—ë—Ç –∏–≥—Ä–∞—Ç—å

4. ‚úÖ –ù–∞–∂–º–∏—Ç–µ "Give up" –∏–ª–∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –º–µ–Ω—é
   - Battle –º—É–∑—ã–∫–∞ –∑–∞—Ç—É—Ö–Ω–µ—Ç
   - –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ –≤–µ—Ä–Ω—ë—Ç—Å—è

5. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–ª–∞–π–¥–µ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏
   - –ì—Ä–æ–º–∫–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –≤–ª–∏—è—Ç—å –Ω–∞ –æ–±–µ –º—É–∑—ã–∫–∏

6. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–Ω–æ–ø–∫—É mute
   - –î–æ–ª–∂–Ω–∞ –≤—ã–∫–ª—é—á–∞—Ç—å –≤–µ—Å—å –∑–≤—É–∫

## üé® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Fade –ø–µ—Ä–µ—Ö–æ–¥—ã
```typescript
playMusic(src, fadeDuration = 500)
```
- –¢–µ–∫—É—â–∏–π —Ç—Ä–µ–∫ –∑–∞—Ç—É—Ö–∞–µ—Ç –∑–∞ 500ms
- –ù–æ–≤—ã–π —Ç—Ä–µ–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞ 500ms
- –ü–ª–∞–≤–Ω—ã–π, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥

### –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
```typescript
useEffect(() => {
  playBattleMusic();
  
  return () => {
    playMainTheme(); // Cleanup –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
  };
}, []);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```typescript
// –ï—Å–ª–∏ —Ç–æ—Ç –∂–µ —Ç—Ä–µ–∫ —É–∂–µ –∏–≥—Ä–∞–µ—Ç - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
if (currentMusicKey === src && currentMusic?.playing()) {
  return;
}
```

## üìã –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø

**–≠—Ç–∞–ø 3: UI –∑–≤—É–∫–∏ (–æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–µ–π)**
- –ó–≤—É–∫ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
- –ó–≤—É–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—ë–º, –∫—Ä–∞—Ñ—Ç–æ–º, —ç–∫—Å–ø–µ–¥–∏—Ü–∏—è–º–∏

–ì–æ—Ç–æ–≤—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å? üöÄ
